; ═══════════════════════════════════════════════════════════════════════════
; PlatformIO Configuration - Ultra Pro Air Drum (FIXED)
; ═══════════════════════════════════════════════════════════════════════════

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

; Serial Monitor Settings
monitor_speed = 115200
monitor_filters = esp32_exception_decoder

; Build Optimization & BLE Stack Configuration
build_flags = 
    -O3                                    ; Maximum optimization
    -DCORE_DEBUG_LEVEL=1                   ; Minimal debug (reduce overhead)
    -DCONFIG_BT_NIMBLE_ENABLED             ; Enable NimBLE stack
    -DCONFIG_BLUEDROID_ENABLED=0           ; Disable old Bluedroid BLE stack (CRITICAL FIX)
    -DCONFIG_BT_BLE_ENABLED=1              ; Keep BLE enabled
    -DCONFIG_BTDM_CTRL_MODE_BLE_ONLY       ; BLE-only mode (no classic BT)
    -DCONFIG_BT_NIMBLE_ROLE_PERIPHERAL     ; We're a peripheral device

; Library Dependencies (REMOVED BLE Keyboard - causes conflict)
lib_deps = 
    electroniccats/MPU6050@^1.0.0
    h2zero/NimBLE-Arduino@^1.4.1
    ; Removed: t-vk/ESP32 BLE Keyboard (conflicts with NimBLE)

; Upload Settings (adjust for your setup)
upload_speed = 921600
upload_port = COM5      ; Windows: Change to your COM port | Linux/Mac: /dev/ttyUSB0

; Partition Scheme (if BLE needs more space)
board_build.partitions = huge_app.csv

; Build unflags - explicitly remove old BLE references
build_unflags = 
    -DCONFIG_BLUEDROID_ENABLED